# Word 模板自动填写工具 - 使用说明

## 🚀 快速开始

### 第一步：安装依赖
双击运行 **`下载依赖.bat`**，等待下载完成（需要联网）。

### 第二步：打开工具
双击打开 **`index.html`** 文件。

### 第三步：设置工作区（推荐）
1. 点击左下角的 **📁 设置工作区** 按钮
2. 选择一个文件夹（建议新建一个空文件夹）
3. 授予读写权限
4. 完成！数据将保存为本地文件

---

## 📖 功能说明

### 1. 创建模板
1. 点击 **"新建模板"**
2. 填写模板名称和描述
3. 上传 Word 模板文件（.docx）
4. 配置字段：
   - **字段 Key**：Word 中的占位符（如 `{客户名称}`）
   - **显示名称**：表单中显示的名称
   - **字段类型**：文本或数字
5. 配置明细表（可选）：
   - **表名**：Word 中的循环标签（如 `{#基站明细}`）
   - **列配置**：定义表格的列
6. 点击 **"模板自检"** 验证配置
7. 点击 **"保存模板"**

**Word 模板占位符格式：**
- 普通字段：`{字段名}`
- 明细表：
  ```
  {#表名}
  {列1} {列2} {列3}
  {/表名}
  ```

### 2. 填写表单
1. 在模板列表点击 **"开始填写"**
2. 填写表单字段
3. 填写明细表数据（支持从 Excel 粘贴）
4. 输入文件名
5. 点击 **"生成 Word"** 下载文档

**快捷功能：**
- 点击 **"保存记录"** 保存当前填写的数据
- 点击 **"载入历史"** 从历史记录载入数据
- 明细表支持 **"粘贴数据"**，可直接从 Excel 复制粘贴

### 3. 管理历史
1. 切换到 **"历史记录"** 视图
2. 可以筛选、查看、打开、复制、删除记录
3. 可以导出数据包

---

## 💾 数据存储

### 本地文件存储（推荐）
**优点：**
- ✅ 数据保存在本地文件，永不丢失
- ✅ 可以直接查看、编辑 JSON 文件
- ✅ 轻松备份（复制文件夹即可）
- ✅ 支持网盘同步（OneDrive、百度网盘等）

**文件结构：**
```
工作区文件夹/
├── templates/          # 模板文件
│   ├── 模板ID1.json
│   └── 模板ID2.json
└── records/            # 记录文件
    ├── 模板ID1/
    │   ├── 记录ID1.json
    │   └── 记录ID2.json
    └── 模板ID2/
```

**浏览器支持：**
- ✅ Chrome 86+
- ✅ Edge 86+
- ✅ Opera 72+
- ❌ Firefox（会自动回退到浏览器存储）
- ❌ Safari（会自动回退到浏览器存储）

### 浏览器存储（备用）
如果浏览器不支持文件存储，会自动使用浏览器 IndexedDB 存储。

---

## 🔧 常用操作

### 备份数据
- 方法1：复制整个工作区文件夹
- 方法2：点击左下角 **📥 备份** 按钮下载备份文件

### 恢复数据
- 方法1：将工作区文件夹复制回来
- 方法2：点击左下角 **📤 恢复** 按钮导入备份文件

### 导入/导出
- **导出模板包**：模板卡片 → ⋯ → 导出模板包
- **导出数据包**：历史记录 → 导出数据包
- **导入模板**：模板列表 → 导入模板
- **导入数据**：历史记录 → 导入数据包

---

## 💡 使用技巧

1. **字段排序**：编辑模板时，使用 ⬆️ ⬇️ 按钮调整字段顺序
2. **表格粘贴**：填写明细表时，点击"粘贴数据"从 Excel 复制粘贴
3. **定期备份**：建议定期备份工作区文件夹或下载备份文件
4. **网盘同步**：将工作区设置在网盘文件夹中，实现多设备同步

---

## ❓ 常见问题

**Q：如何修改已创建的模板？**  
A：模板卡片 → ⋯ → 编辑模板

**Q：如何查看某个模板的所有记录？**  
A：模板卡片 → ⋯ → 查看历史

**Q：换浏览器或换电脑怎么办？**  
A：备份工作区文件夹或下载备份文件，在新环境恢复即可

**Q：Word 模板验证失败怎么办？**  
A：检查 Word 中的占位符格式，确保：
- 普通字段使用 `{字段名}`
- 明细表循环使用 `{#表名}...{/表名}`
- 标签名称与配置中的 Key 完全一致

**Q：如何诊断问题？**  
A：双击打开 **诊断工具.html**，检查存储状态

---

## 📋 文件说明

```
流程自动编写小工具/
├── index.html              # 主程序（双击打开）
├── 下载依赖.bat            # 依赖安装脚本
├── 诊断工具.html           # 存储诊断工具
├── 使用说明.md             # 本说明文件
├── css/                    # 样式文件
├── js/                     # 程序代码
└── libs/                   # 依赖库（运行下载脚本后生成）
```

---

## ⚠️ 注意事项

1. **首次使用前务必运行 `下载依赖.bat`**
2. **推荐使用 Chrome 或 Edge 浏览器**
3. **设置工作区后不要删除或移动文件夹**
4. **定期备份数据**

---

**开始使用吧！** 🎉
